<HTML>
<HEAD>
<TITLE> Kakadu Hyper-Doc (kdu_block::map_storage) </TITLE>
<STYLE TYPE="text/css">
<!--
.indented-text { padding-left: 20pt; }
.function-text { padding-left: 80pt;
                 text-indent: -60pt; }
-->
</STYLE>
</HEAD>
<BODY TEXT="#000000" LINK="#0000ff" BGCOLOR="#B4DCB4">
<P ALIGN="RIGHT">|<A HREF="#SynopsiS"> synopsis </A>||<A HREF="#ArgS"> arguments </A>||<A HREF="kdu_block__set$_contexts.html"> prev </A>||<A HREF="kdu_block__get_size.html"> next </A>|</P>
<H1><A NAME="ToP">kdu_block::map_storage</A></H1>
<DIR><DIR><H3><EM><U>Java:</U> Kdu_block.Map_storage</EM></H3></DIR></DIR>
<P CLASS="function-text"><B>int</B> map_storage(
<B>int</B>&nbsp;contexts,
<B>int</B>&nbsp;samples,
<B>int</B>&nbsp;retained_state)</P>
<DIR><DIR><P CLASS="function-text"><EM><U>Java:</U> public native int Map_storage(
int&nbsp;contexts,
int&nbsp;samples,
int&nbsp;retained_state)</EM></P></DIR></DIR>
<P>[Declared in <A HREF="++++coresy$u_compressed+h.html">"../coresys/common/kdu_compressed.h"</A>]</P><P><A HREF="kdu_block.html">Go to class description.</A></P>

<P ALIGN="CENTER"><HR></P><H2><A NAME="SynopsiS">Synopsis</A></H2>
<DIV CLASS="indented-text">
<P>
This function is intended to improve memory localization
and help avoid the need for some unnecessary initialization
operations. It is intended for use by block encoding
and decoding machinery.
</P><P>
 To understand this function, you should first realize
that the 
<A HREF="kdu_block.html#max_contexts">max_contexts</A> and 
<A HREF="kdu_block.html#max_samples">max_samples</A> members identify the currently allocated sizes of
distinct blocks of memory to which the 
<A HREF="kdu_block.html#context_buffer">context_buffer</A> and 
<A HREF="kdu_block.html#sample_buffer">sample_buffer</A> members point. The present function is able to arrange
for either or both of these members to point into a
separate contiguous block of memory. When this happens,
the corresponding byte limit is set to 0, so that parts
of an application that expect to be able to independently
adjust the size of the context buffer, sample buffer
or byte buffer will be forced to invoke 
<A HREF="kdu_block__set$_contexts.html">set_max_contexts</A> or 
<A HREF="kdu_block__set$x_samples.html">set_max_samples</A>, as appropriate.
</P><UL><LI>
If 
<A HREF="kdu_block__map_storage.html#contexts">contexts</A> is non-zero, the 
<A HREF="kdu_block.html#context_buffer">context_buffer</A> member is made to point to the start of the contiguous
block of memory associated with this function and 
<A HREF="kdu_block.html#max_contexts">max_contexts</A> is set to 0. Space is set aside for 
<A HREF="kdu_block__map_storage.html#contexts">contexts</A> 32-bit integers to reside within the contiguous block
of memory, aligned on a 32-byte boundary.
</LI><LI>
If 
<A HREF="kdu_block__map_storage.html#samples">samples</A> is non-zero, the 
<A HREF="kdu_block.html#sample_buffer">sample_buffer</A> member is made to point into the contiguous block
of memory associated with this function and 
<A HREF="kdu_block.html#max_samples">max_samples</A> is set to 0. Space is set aside for 
<A HREF="kdu_block__map_storage.html#samples">samples</A> 32-bit integers to reside within the contiguous block
of memory and the 
<A HREF="kdu_block.html#sample_buffer">sample_buffer</A> is aligned on a 32-byte boundary.
</LI></UL><P>
 Note that 
<A HREF="kdu_block__map_storage.html#contexts">contexts</A> is special, in that any remapped 
<A HREF="kdu_block.html#context_buffer">context_buffer</A> member always points to the start of the contiguous
block of memory associated with this function. If 
<A HREF="kdu_block__map_storage.html#contexts">contexts</A> is 0, this role is taken by the sample buffer.
</P><P>
 The function also records any 
<A HREF="kdu_block__map_storage.html#retained_state">retained_state</A> value internally, returning the value last recorded
by a call to this function, or else 0. The value 0
is returned if the function has never been called,
if the contiguous block of memory needed to be reallocated
as a result of this call, or if the call caused either
the 
<A HREF="kdu_block.html#context_buffer">context_buffer</A> or 
<A HREF="kdu_block.html#sample_buffer">sample_buffer</A> pointer to be changed. Typically the caller uses 
<A HREF="kdu_block__map_storage.html#retained_state">retained_state</A> and the function's return value to determine whether
some portion of the 
<A HREF="kdu_block.html#context_buffer">context_buffer</A> can be used without re-initialization.
</P>
</DIV>

<P ALIGN="CENTER"><HR></P><H2><A NAME="ArgS">Arguments</A></H2><DIV CLASS="indented-text">
<H4><A NAME="contexts">contexts</A> [<B>int</B>]</H4><DIV CLASS="indented-text">
</DIV>
<H4><A NAME="samples">samples</A> [<B>int</B>]</H4><DIV CLASS="indented-text">
</DIV>
<H4><A NAME="retained_state">retained_state</A> [<B>int</B>]</H4><DIV CLASS="indented-text">
</DIV>
</DIV>

<P ALIGN="CENTER"><HR></P><P ALIGN="RIGHT">|<A HREF="#ToP"> top </A>||<A HREF="#SynopsiS"> synopsis </A>||<A HREF="#ArgS"> arguments </A>||<A HREF="kdu_block__set$_contexts.html"> prev </A>||<A HREF="kdu_block__get_size.html"> next </A>|</P>
</BODY>
</HTML>
